{
  "meta": {
    "name": "PO3_entry_exit_checklist_machine_readable",
    "version": "1.0",
    "generated_by": "Clara-g",
    "generated_on": "2026-01-05",
    "description": "Checklist machine-readable des règles d'entrée/sortie PO3 basée sur trader_po3_indicator_V1 (normalisée). Chaque étape a un identifiant, priorité et action (check/compute/execute/alert). Valeurs null doivent être renseignées avant automatisation complète."
  },
  "checklist_steps": [
    {
      "id": "pretrade_01_instrument_allowed",
      "priority": 1,
      "type": "check",
      "description": "Vérifier que le symbole est autorisé (NQ ou MNQ).",
      "input": {
        "symbol": "string"
      },
      "pass_condition": "symbol in [\"NQ\", \"MNQ\"]",
      "on_fail": "cancel_signal",
      "automation_action": "block"
    },
    {
      "id": "pretrade_02_trading_hours",
      "priority": 2,
      "type": "check",
      "description": "Vérifier que on est dans plage horaire autorisée et pas à l'approche de la fermeture 22:59 (timezone non renseignée).",
      "input": {
        "current_utc_time": "ISO8601",
        "timezone_setting": "string or null"
      },
      "pass_condition": "within_allowed_hours AND current_time < close_cutoff_time",
      "on_fail": "cancel_signal_or_alert_user",
      "automation_action": "block_or_alert"
    },
    {
      "id": "pretrade_03_news_filter",
      "priority": 3,
      "type": "check",
      "description": "Vérifier qu'aucune news high-impact n'est programmée dans la fenêtre bloque (15 minutes by default).",
      "input": {
        "news_calendar": "list of events with impact and time",
        "filter_minutes_before": 15
      },
      "pass_condition": "no_high_impact_event_within(filter_minutes_before)",
      "on_fail": "cancel_signal",
      "automation_action": "block"
    },
    {
      "id": "htf_01_trend_alignment",
      "priority": 4,
      "type": "check",
      "description": "Confirmer la tendance HTF (M5-M15) est en accord avec la direction du setup PO3.",
      "input": {
        "htf_series": "price series M5/M15",
        "direction": "long|short"
      },
      "pass_condition": "HTF shows structure aligned with direction (e.g., HH/HL for long)",
      "on_fail": "cancel_or_lower_priority",
      "automation_action": "compute"
    },
    {
      "id": "po3_01_detect_phase2_sweep",
      "priority": 5,
      "type": "check",
      "description": "Détecter sweep / liquidity grab (Phase 2) : wick extrême + volume spike + rejet.",
      "input": {
        "ltf_series": "M1 price series",
        "atr": "number",
        "volume": "series",
        "wick_length_threshold_multiplier_of_atr": null,
        "volume_spike_ratio_vs_N": null,
        "rejection_close_threshold_pct_vs_wick": null
      },
      "pass_condition": "wick_length >= wick_length_threshold AND volume >= volume_spike_ratio AND quick_recovery_within_N_candles",
      "on_fail": "do_not_enter",
      "automation_action": "compute_and_alert_if_manual_needed"
    },
    {
      "id": "po3_02_find_orderblock_or_fvg",
      "priority": 6,
      "type": "check",
      "description": "Identifier OB (orderblock) ou FVG (fair value gap) sur timeframe M5-M15; if no OB but OTE present, accept FVG.",
      "input": {
        "htf_timeframes": [
          5,
          15
        ],
        "search_window_bars": 50
      },
      "pass_condition": "orderblock_found OR fvg_found",
      "on_fail": "do_not_enter",
      "automation_action": "compute"
    },
    {
      "id": "ote_01_validate_ote",
      "priority": 7,
      "type": "check",
      "description": "Calculer OTE (Fibonacci 50-78.6%) sur move initial et vérifier si price returned inside OTE bounds.",
      "input": {
        "swing_start": "price",
        "swing_end": "price",
        "ote_bounds_pct": {
          "min": 50,
          "max": 78.6
        }
      },
      "pass_condition": "current_price within OTE bounds",
      "on_fail": "fallback_to_FVG_or_cancel",
      "automation_action": "compute"
    },
    {
      "id": "entry_01_entry_signal_confirmed",
      "priority": 8,
      "type": "decision",
      "description": "Vérifier séquentiellement : HTF trend OK, sweep confirmé, OB or FVG present, OTE valid (if applicable), spread OK, volume confirmation OK.",
      "input": {
        "spread_ticks_allowed": null,
        "volume_confirmation_ratio": null,
        "max_time_since_signal_seconds": null
      },
      "pass_condition": "all_required_checks_pass",
      "on_fail": "cancel_signal",
      "automation_action": "if entry_mode.manual_phase_detection == true => alert_trader_for_final_ok else => execute_order"
    },
    {
      "id": "risk_01_position_sizing",
      "priority": 9,
      "type": "compute",
      "description": "Calculer la taille de position basée sur risk_per_trade_pct et distance SL en ticks / USD.",
      "input": {
        "account_size_usd": 50000,
        "risk_per_trade_pct": 0.5,
        "stop_distance_ticks": "number",
        "tick_value_usd": "from contract details"
      },
      "output": {
        "risk_usd": 250,
        "contracts_qty": "computed_integer_or_decimal_for_mnq"
      },
      "automation_action": "compute_and_return_order_size"
    },
    {
      "id": "order_01_execution_rule",
      "priority": 10,
      "type": "execute",
      "description": "Placer ordre selon préférence (limit in OB/OTE, fallback market after N seconds).",
      "input": {
        "entry_type_preference": null,
        "limit_wait_seconds": null,
        "convert_to_market_after_wait": true
      },
      "on_fail": "cancel_or_alert",
      "automation_action": "execute_or_alert"
    },
    {
      "id": "sl_tp_01_stoploss_placement",
      "priority": 11,
      "type": "compute",
      "description": "Placer SL sous/au-dessus du sweep wick ou ordine block; taille SL exprimée en ticks et en %ATR.",
      "input": {
        "sweep_wick_low_high": "price",
        "preferred_sl_buffer_ticks": null,
        "sl_max_pct_of_account": null
      },
      "output": {
        "sl_price": "number",
        "sl_ticks": "number"
      },
      "automation_action": "place_sl"
    },
    {
      "id": "tp_01_takeprofit_levels",
      "priority": 12,
      "type": "compute",
      "description": "Définir TP1/TP2/TP3 (structure opposite, prev high/low, fib ext 1.27/1.618). Respecter RR >= 1.5 minimal.",
      "input": {
        "rr_min": 1.5,
        "tp_levels": [
          "structure",
          "fib_1.27",
          "fib_1.618"
        ],
        "partial_close_percents": null
      },
      "output": {
        "tp_prices": "list",
        "expected_rr": "number"
      },
      "automation_action": "place_tps"
    },
    {
      "id": "posttrade_01_post_execution_confirm",
      "priority": 13,
      "type": "check",
      "description": "Après exécution, vérifier que SL et TP placés correctement et que taille réelle correspond à calcul.",
      "input": {
        "placed_orders": "broker response"
      },
      "pass_condition": "orders match expected",
      "on_fail": "attempt_fix_or_alert",
      "automation_action": "verify_and_fix_or_alert"
    },
    {
      "id": "posttrade_02_time_and_daily_limits",
      "priority": 14,
      "type": "check",
      "description": "Vérifier limites journalières (stop trading si perte journalière >= configured threshold) et fermer positions avant 22:59.",
      "input": {
        "daily_pnl_usd": "number",
        "daily_pnl_pct": "number",
        "daily_loss_threshold_pct": null,
        "close_cutoff_time": "22:59 (timezone to fill)"
      },
      "pass_condition": "daily_pnl_pct < threshold AND current_time < close_cutoff_time",
      "on_fail": "close_positions_and_pause_trading",
      "automation_action": "close_positions_and_suspend_signals"
    },
    {
      "id": "reporting_01_trade_logging",
      "priority": 15,
      "type": "log",
      "description": "Stocker un rapport minimal par trade: tradeId, symbol, entry, sl, tp, size, rationale, confluence_list, screenshots_required_flag.",
      "input": {
        "rationale_text": "string",
        "confluence_list": [
          "HTF trend",
          "sweep",
          "OB/FVG",
          "OTE"
        ],
        "screenshot": "boolean"
      },
      "output": {
        "trade_record_saved": true
      },
      "automation_action": "log"
    },
    {
      "id": "kpi_01_performance_tracking",
      "priority": 16,
      "type": "compute",
      "description": "Mettre à jour KPIs par trade (winrate, expectancy, drawdown) et mesurer critères de validation de la stratégie sur période.",
      "input": {
        "trade_history": "list",
        "validation_period_min_trades": null,
        "validation_period_weeks": null
      },
      "output": {
        "winrate": "pct",
        "expectancy": "usd_per_trade",
        "max_drawdown": "pct"
      },
      "automation_action": "update_metrics_and_alert_if_thresholds_exceeded"
    }
  ],
  "fields_to_fill_before_full_automation": {
    "timezone": null,
    "wick_length_threshold_multiplier_of_atr": null,
    "volume_spike_ratio_vs_N": null,
    "rejection_close_threshold_pct_vs_wick": null,
    "spread_ticks_allowed": null,
    "volume_confirmation_ratio": null,
    "limit_wait_seconds": null,
    "preferred_sl_buffer_ticks": null,
    "partial_close_percents": null,
    "daily_loss_threshold_pct": null,
    "validation_period_min_trades": null,
    "validation_period_weeks": null
  },
  "usage_notes": "Remplir les champs 'fields_to_fill_before_full_automation' avec valeurs chiffrées (ticks, ratios, seconds, %) avant déploiement live. Le flux prévoit détection manuelle de la phase de manipulation (entry_mode.manual_phase_detection=true) mais automatise le sizing/exécution/gestion une fois validé."
}